{
 "cells": [
  {
   "cell_type": "markdown",
   "source": [
    "# Example 1: Grab metadata from a dataset\n",
    "\n",
    "In this example, we will learn how to get metadata of each file in dataset.  \n",
    "The metadata contains deterministic information (e.g. recording date, duration, etc.)\n",
    "as well as heuristic information such as tags."
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%% md\n"
    }
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "## Grab a DataFrame of metadata from a database\n",
    "\n",
    "Firstly, let's import a metadata handler from the toolkit and initialize it."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "outputs": [],
   "source": [
    "from dwtk.db import V3DBHandler as DBHandler\n",
    "\n",
    "db_handler = DBHandler(\n",
    "    db_class='meta',\n",
    "    db_host='/data_pool_1/small_DrivingBehaviorDatabase/dwtk.db',\n",
    "    base_dir_path='/data_pool_1/small_DrivingBehaviorDatabase',\n",
    "    read_on_init=True\n",
    ")"
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%%\n"
    }
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "If you set `read_on_init` to `True`, the entire contents in the database will be loaded\n",
    "and stored into the local memory as a Pandas DataFrame.  \n",
    "You can access to the contents as follows."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "outputs": [
    {
     "data": {
      "text/plain": "          description                database_id                 record_id  \\\n0    Driving Database  Driving Behavior Database  W07_17000000020000001255   \n1    Driving Database  Driving Behavior Database  016_00000000030000000240   \n2    Driving Database  Driving Behavior Database  016_00000000030000000240   \n3    Driving Database  Driving Behavior Database  253_16000000080000000747   \n4    Driving Database  Driving Behavior Database  253_16000000080000000747   \n..                ...                        ...                       ...   \n187  Driving Database  Driving Behavior Database  253_16000000080000000747   \n188  Driving Database  Driving Behavior Database  W07_17000000020000001255   \n189  Driving Database  Driving Behavior Database  016_00000000030000000240   \n190  Driving Database  Driving Behavior Database  016_00000000030000000215   \n191  Driving Database  Driving Behavior Database  253_16000000080000000747   \n\n    data_type                                               path  \\\n0    raw_data  records/W07_17000000020000001255/data/records.bag   \n1    raw_data  records/016_00000000030000000240/data/records.bag   \n2    raw_data  records/016_00000000030000000240/data/camera_0...   \n3    raw_data  records/253_16000000080000000747/data/records.bag   \n4    raw_data  records/253_16000000080000000747/data/records.bag   \n..        ...                                                ...   \n187  raw_data  records/253_16000000080000000747/data/camera_0...   \n188  raw_data  records/W07_17000000020000001255/data/camera_0...   \n189  raw_data  records/016_00000000030000000240/data/camera_0...   \n190  raw_data  records/016_00000000030000000215/data/records....   \n191  raw_data  records/253_16000000080000000747/data/records.bag   \n\n     start_timestamp  end_timestamp        content_type  \\\n0       1.519881e+09   1.519885e+09  application/rosbag   \n1       1.489728e+09   1.489729e+09  application/rosbag   \n2       1.489728e+09   1.489729e+09           video/mp4   \n3       1.506060e+09   1.506064e+09  application/rosbag   \n4       1.506060e+09   1.506064e+09  application/rosbag   \n..               ...            ...                 ...   \n187     1.506060e+09   1.506064e+09            text/csv   \n188     1.519881e+09   1.519885e+09           video/mp4   \n189     1.489728e+09   1.489729e+09           video/mp4   \n190     1.489455e+09   1.489456e+09  application/rosbag   \n191     1.506060e+09   1.506064e+09  application/rosbag   \n\n                                  contents          msg_type  \\\n0              /vehicle/analog/speed_pulse    std_msgs/UInt8   \n1              /vehicle/analog/speed_pulse    std_msgs/UInt8   \n2                       camera/driver-foot              None   \n3                /gps_m2/vehicle/direction  std_msgs/Float32   \n4                         /driver/face_yaw  std_msgs/Float32   \n..                                     ...               ...   \n187                     camera/rear-center              None   \n188                    camera/front-center              None   \n189                      camera/rear-right              None   \n190           /vehicle/extracted_can/speed    std_msgs/UInt8   \n191  /vehicle/extracted_can/steering_angle  std_msgs/Float32   \n\n                           msg_md5sum     count  frequency  \\\n0    7c8164229e7d2c17eb95e9231617fdee   73200.0  20.000019   \n1    7c8164229e7d2c17eb95e9231617fdee    4800.0  20.000019   \n2                                None       NaN        NaN   \n3    73fcbf46b49191e672908e50842a83d4   45160.0  10.000010   \n4    73fcbf46b49191e672908e50842a83d4  110441.0  33.333365   \n..                                ...       ...        ...   \n187                              None       NaN        NaN   \n188                              None       NaN        NaN   \n189                              None       NaN        NaN   \n190  7c8164229e7d2c17eb95e9231617fdee    3514.0   2.000000   \n191  73fcbf46b49191e672908e50842a83d4  225493.0  50.000048   \n\n                                     tags                        uuid_in_df  \n0              vehicle:analog:speed:pulse  014d15e7b0287f2ae6d632029c3515ae  \n1              vehicle:analog:speed:pulse  034d9659e19ae6450a3ca8ffb15d0341  \n2                camera:driver:foot:image  037128ab35dff0c96c30b6d9df55b68d  \n3                gps:m2:vehicle:direction  046baa361040ff81730714c50a60b5be  \n4                         driver:face:yaw  0566b705a3443d7f18ac7435c9245e8e  \n..                                    ...                               ...  \n187         camera:rear:center:timestamps  fc99d95061e9648ca85f05c7f68dae2f  \n188             camera:front:center:image  fd6e8b96e8ca96dfe23373f4fabddde3  \n189               camera:rear:right:image  fe09dc6169fd6ea290c07b733ec70356  \n190           vehicle:extracted:can:speed  fe7450a89dd571464161723be5014b18  \n191  vehicle:extracted:can:steering:angle  fe8c55521c0bcbe7a89aff5e63ac4088  \n\n[192 rows x 15 columns]",
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>description</th>\n      <th>database_id</th>\n      <th>record_id</th>\n      <th>data_type</th>\n      <th>path</th>\n      <th>start_timestamp</th>\n      <th>end_timestamp</th>\n      <th>content_type</th>\n      <th>contents</th>\n      <th>msg_type</th>\n      <th>msg_md5sum</th>\n      <th>count</th>\n      <th>frequency</th>\n      <th>tags</th>\n      <th>uuid_in_df</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>W07_17000000020000001255</td>\n      <td>raw_data</td>\n      <td>records/W07_17000000020000001255/data/records.bag</td>\n      <td>1.519881e+09</td>\n      <td>1.519885e+09</td>\n      <td>application/rosbag</td>\n      <td>/vehicle/analog/speed_pulse</td>\n      <td>std_msgs/UInt8</td>\n      <td>7c8164229e7d2c17eb95e9231617fdee</td>\n      <td>73200.0</td>\n      <td>20.000019</td>\n      <td>vehicle:analog:speed:pulse</td>\n      <td>014d15e7b0287f2ae6d632029c3515ae</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>016_00000000030000000240</td>\n      <td>raw_data</td>\n      <td>records/016_00000000030000000240/data/records.bag</td>\n      <td>1.489728e+09</td>\n      <td>1.489729e+09</td>\n      <td>application/rosbag</td>\n      <td>/vehicle/analog/speed_pulse</td>\n      <td>std_msgs/UInt8</td>\n      <td>7c8164229e7d2c17eb95e9231617fdee</td>\n      <td>4800.0</td>\n      <td>20.000019</td>\n      <td>vehicle:analog:speed:pulse</td>\n      <td>034d9659e19ae6450a3ca8ffb15d0341</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>016_00000000030000000240</td>\n      <td>raw_data</td>\n      <td>records/016_00000000030000000240/data/camera_0...</td>\n      <td>1.489728e+09</td>\n      <td>1.489729e+09</td>\n      <td>video/mp4</td>\n      <td>camera/driver-foot</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>camera:driver:foot:image</td>\n      <td>037128ab35dff0c96c30b6d9df55b68d</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>253_16000000080000000747</td>\n      <td>raw_data</td>\n      <td>records/253_16000000080000000747/data/records.bag</td>\n      <td>1.506060e+09</td>\n      <td>1.506064e+09</td>\n      <td>application/rosbag</td>\n      <td>/gps_m2/vehicle/direction</td>\n      <td>std_msgs/Float32</td>\n      <td>73fcbf46b49191e672908e50842a83d4</td>\n      <td>45160.0</td>\n      <td>10.000010</td>\n      <td>gps:m2:vehicle:direction</td>\n      <td>046baa361040ff81730714c50a60b5be</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>253_16000000080000000747</td>\n      <td>raw_data</td>\n      <td>records/253_16000000080000000747/data/records.bag</td>\n      <td>1.506060e+09</td>\n      <td>1.506064e+09</td>\n      <td>application/rosbag</td>\n      <td>/driver/face_yaw</td>\n      <td>std_msgs/Float32</td>\n      <td>73fcbf46b49191e672908e50842a83d4</td>\n      <td>110441.0</td>\n      <td>33.333365</td>\n      <td>driver:face:yaw</td>\n      <td>0566b705a3443d7f18ac7435c9245e8e</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>187</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>253_16000000080000000747</td>\n      <td>raw_data</td>\n      <td>records/253_16000000080000000747/data/camera_0...</td>\n      <td>1.506060e+09</td>\n      <td>1.506064e+09</td>\n      <td>text/csv</td>\n      <td>camera/rear-center</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>camera:rear:center:timestamps</td>\n      <td>fc99d95061e9648ca85f05c7f68dae2f</td>\n    </tr>\n    <tr>\n      <th>188</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>W07_17000000020000001255</td>\n      <td>raw_data</td>\n      <td>records/W07_17000000020000001255/data/camera_0...</td>\n      <td>1.519881e+09</td>\n      <td>1.519885e+09</td>\n      <td>video/mp4</td>\n      <td>camera/front-center</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>camera:front:center:image</td>\n      <td>fd6e8b96e8ca96dfe23373f4fabddde3</td>\n    </tr>\n    <tr>\n      <th>189</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>016_00000000030000000240</td>\n      <td>raw_data</td>\n      <td>records/016_00000000030000000240/data/camera_0...</td>\n      <td>1.489728e+09</td>\n      <td>1.489729e+09</td>\n      <td>video/mp4</td>\n      <td>camera/rear-right</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>camera:rear:right:image</td>\n      <td>fe09dc6169fd6ea290c07b733ec70356</td>\n    </tr>\n    <tr>\n      <th>190</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>016_00000000030000000215</td>\n      <td>raw_data</td>\n      <td>records/016_00000000030000000215/data/records....</td>\n      <td>1.489455e+09</td>\n      <td>1.489456e+09</td>\n      <td>application/rosbag</td>\n      <td>/vehicle/extracted_can/speed</td>\n      <td>std_msgs/UInt8</td>\n      <td>7c8164229e7d2c17eb95e9231617fdee</td>\n      <td>3514.0</td>\n      <td>2.000000</td>\n      <td>vehicle:extracted:can:speed</td>\n      <td>fe7450a89dd571464161723be5014b18</td>\n    </tr>\n    <tr>\n      <th>191</th>\n      <td>Driving Database</td>\n      <td>Driving Behavior Database</td>\n      <td>253_16000000080000000747</td>\n      <td>raw_data</td>\n      <td>records/253_16000000080000000747/data/records.bag</td>\n      <td>1.506060e+09</td>\n      <td>1.506064e+09</td>\n      <td>application/rosbag</td>\n      <td>/vehicle/extracted_can/steering_angle</td>\n      <td>std_msgs/Float32</td>\n      <td>73fcbf46b49191e672908e50842a83d4</td>\n      <td>225493.0</td>\n      <td>50.000048</td>\n      <td>vehicle:extracted:can:steering:angle</td>\n      <td>fe8c55521c0bcbe7a89aff5e63ac4088</td>\n    </tr>\n  </tbody>\n</table>\n<p>192 rows × 15 columns</p>\n</div>"
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "db_handler.df"
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%%\n"
    }
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "When you want to handle a very large dataset, the metadata contains huge amount of information and as a result,\n",
    "it takes a long time to load all of it.  \n",
    "However, if you want to grab only a limited scope (e.g. metadata of files tagged 'camera' and 'front'),\n",
    "it is costful to load all the dataset and search items on the loaded dataframe.  \n",
    "Therefore, the toolkit provides a method to execute a sql query before loading the database\n",
    "and limit the items to load.  \n",
    "\n",
    "To execute a sql query before loading metadata, you should set `read_on_init` option to `False` as follows."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "# of metadata: 89\n",
      "# of metadata: 24\n",
      "# of metadata: 4\n",
      "# of metadata: 84\n"
     ]
    }
   ],
   "source": [
    "db_handler = DBHandler( \n",
    "    db_class='meta',\n",
    "    db_host='/data_pool_1/small_DrivingBehaviorDatabase/dwtk.db',\n",
    "    base_dir_path='/data_pool_1/small_DrivingBehaviorDatabase',\n",
    "    read_on_init=False\n",
    ")\n",
    "db_handler.read(where='start_timestamp > 1500000000')\n",
    "print('# of metadata: {}'.format(len(db_handler.df)))\n",
    "db_handler.read(where='tags like \"%camera%\" and tags like \"%front%\"')\n",
    "print('# of metadata: {}'.format(len(db_handler.df)))\n",
    "db_handler.read(where='tags like \"%can%\" and tags like \"%steering%\"')\n",
    "print('# of metadata: {}'.format(len(db_handler.df)))\n",
    "db_handler.read(where='tags like \"%can%\" or tags like \"%camera%\"')\n",
    "print('# of metadata: {}'.format(len(db_handler.df)))"
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%%\n"
    }
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "## Get list for record_id corresponding to metadata\n",
    "\n",
    "Each row of the dataframe acquired above corresponds to a file in the dataset.  \n",
    "If you wan to know which record-id the file belongs to, you can get a dataframe of records as follows."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "outputs": [
    {
     "data": {
      "text/plain": "                  record_id  start_timestamp  end_timestamp  \\\n0  016_00000000030000000215     1.489455e+09   1.489456e+09   \n1  016_00000000030000000240     1.489728e+09   1.489729e+09   \n2  253_16000000080000000747     1.506060e+09   1.506064e+09   \n3  W07_17000000020000001255     1.519881e+09   1.519885e+09   \n\n                                                tags  duration  \n0  [driver, center, angle, front, brake, position...  1755.957  \n1  [driver, center, angle, front, brake, position...   240.957  \n2  [driver, center, angle, front, brake, position...  4512.957  \n3  [timestamps, center, camera, image, front, rig...  3478.957  ",
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>record_id</th>\n      <th>start_timestamp</th>\n      <th>end_timestamp</th>\n      <th>tags</th>\n      <th>duration</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>016_00000000030000000215</td>\n      <td>1.489455e+09</td>\n      <td>1.489456e+09</td>\n      <td>[driver, center, angle, front, brake, position...</td>\n      <td>1755.957</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>016_00000000030000000240</td>\n      <td>1.489728e+09</td>\n      <td>1.489729e+09</td>\n      <td>[driver, center, angle, front, brake, position...</td>\n      <td>240.957</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>253_16000000080000000747</td>\n      <td>1.506060e+09</td>\n      <td>1.506064e+09</td>\n      <td>[driver, center, angle, front, brake, position...</td>\n      <td>4512.957</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>W07_17000000020000001255</td>\n      <td>1.519881e+09</td>\n      <td>1.519885e+09</td>\n      <td>[timestamps, center, camera, image, front, rig...</td>\n      <td>3478.957</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "db_handler.record_id_df"
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%%\n"
    }
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "You can get list of contents as well."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "outputs": [
    {
     "data": {
      "text/plain": "                   record_id  \\\n0   016_00000000030000000240   \n1   016_00000000030000000215   \n2   016_00000000030000000240   \n3   016_00000000030000000240   \n4   016_00000000030000000215   \n..                       ...   \n79  253_16000000080000000747   \n80  W07_17000000020000001255   \n81  016_00000000030000000240   \n82  016_00000000030000000215   \n83  253_16000000080000000747   \n\n                                                 path  \\\n0   /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n1   /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n2   /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n3   /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n4   /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n..                                                ...   \n79  /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n80  /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n81  /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n82  /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n83  /data_pool_1/small_DrivingBehaviorDatabase/rec...   \n\n                                  content          msg_type  \\\n0                      camera/driver-foot              None   \n1      camera/driver-face-black_and_white              None   \n2                       camera/rear-right              None   \n3                      camera/rear-center              None   \n4                       camera/front-left              None   \n..                                    ...               ...   \n79                     camera/rear-center              None   \n80                    camera/front-center              None   \n81                      camera/rear-right              None   \n82           /vehicle/extracted_can/speed    std_msgs/UInt8   \n83  /vehicle/extracted_can/steering_angle  std_msgs/Float32   \n\n                                               tag  \n0                    [camera, image, foot, driver]  \n1   [black_and_white, driver, camera, image, face]  \n2                [camera, timestamps, rear, right]  \n3               [camera, timestamps, rear, center]  \n4                     [camera, image, front, left]  \n..                                             ...  \n79              [camera, timestamps, rear, center]  \n80                  [camera, image, front, center]  \n81                    [camera, image, rear, right]  \n82                [speed, extracted, can, vehicle]  \n83      [extracted, can, steering, angle, vehicle]  \n\n[84 rows x 5 columns]",
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>record_id</th>\n      <th>path</th>\n      <th>content</th>\n      <th>msg_type</th>\n      <th>tag</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>016_00000000030000000240</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/driver-foot</td>\n      <td>None</td>\n      <td>[camera, image, foot, driver]</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>016_00000000030000000215</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/driver-face-black_and_white</td>\n      <td>None</td>\n      <td>[black_and_white, driver, camera, image, face]</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>016_00000000030000000240</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/rear-right</td>\n      <td>None</td>\n      <td>[camera, timestamps, rear, right]</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>016_00000000030000000240</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/rear-center</td>\n      <td>None</td>\n      <td>[camera, timestamps, rear, center]</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>016_00000000030000000215</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/front-left</td>\n      <td>None</td>\n      <td>[camera, image, front, left]</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>79</th>\n      <td>253_16000000080000000747</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/rear-center</td>\n      <td>None</td>\n      <td>[camera, timestamps, rear, center]</td>\n    </tr>\n    <tr>\n      <th>80</th>\n      <td>W07_17000000020000001255</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/front-center</td>\n      <td>None</td>\n      <td>[camera, image, front, center]</td>\n    </tr>\n    <tr>\n      <th>81</th>\n      <td>016_00000000030000000240</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>camera/rear-right</td>\n      <td>None</td>\n      <td>[camera, image, rear, right]</td>\n    </tr>\n    <tr>\n      <th>82</th>\n      <td>016_00000000030000000215</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>/vehicle/extracted_can/speed</td>\n      <td>std_msgs/UInt8</td>\n      <td>[speed, extracted, can, vehicle]</td>\n    </tr>\n    <tr>\n      <th>83</th>\n      <td>253_16000000080000000747</td>\n      <td>/data_pool_1/small_DrivingBehaviorDatabase/rec...</td>\n      <td>/vehicle/extracted_can/steering_angle</td>\n      <td>std_msgs/Float32</td>\n      <td>[extracted, can, steering, angle, vehicle]</td>\n    </tr>\n  </tbody>\n</table>\n<p>84 rows × 5 columns</p>\n</div>"
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "db_handler.content_df\n",
    "\n"
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%%\n"
    }
   }
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}